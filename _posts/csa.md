---
title: '撞庫攻擊實例'
excerpt: '透過相同IP連續時間大量登入的紀錄，應該是使用程式輸入用戶帳號，以及密碼，密集進行網頁的登入，進入之後查詢這個帳戶的歷史購物紀錄。因為程式讀取消費者個人資料，單位時間使用同一個IP位址發送登入的查詢，可以讀取最多的資料。如果因此取得消費者的相關個資與訂單資訊，就可以作為詐騙集團使用電話詐騙的有利資訊，這樣就是所謂的撞庫攻擊。'
coverImage: '/assets/blog/csa/credential-stuffing-attack.jpg'
date: '2023-12-27T05:35:07.322Z'
author:
  name: Kengyu
  picture: '/assets/blog/authors/ky.jpg'
ogImage:
  url: '/assets/blog/csa/credential-stuffing-attack.jpg'
---

## 撞庫攻擊的真實案例

![Credential Stuffing Attac](/assets/blog/csa/csa.jpg "Credential Stuffing Attack")

這是過去處理資安事故的一個實際案例，一家知名的電商過去7年從未發生資安事故，卻在一年當中發生大量的個資外洩事件。調查過程當中這家公司的資安人員號稱他們的網站存取紀錄一天超過200G，詳細檢查並未發現所謂的SQL Injection或XSS等惡意攻擊成功的紀錄，卻發現這些連續時間大量的成功登入紀錄都是來自數組相同IP。

這家電商對於他們公司的控制措施很有信心，即使在他們公司內部也無法連連接外部網路，就算感染網路病毒也不會突破他們的內部伺服器，判斷這是很明顯的來自外部惡意攻擊行為。

這些透過相同IP連續時間大量登入的紀錄，應該是使用程式輸入用戶帳號，以及密碼，密集進行網頁的登入，進入之後查詢這個帳戶的歷史購物紀錄。因為程式讀取消費者個人資料，單位時間使用同一個IP位址發送登入的查詢，可以讀取最多的資料。如果因此取得消費者的相關個資與訂單資訊，就可以作為詐騙集團使用電話詐騙的有利資訊，這樣就是所謂的撞庫攻擊。

## 撞庫攻擊的根因

大多數的民眾管理網路的各種應用以及社群網路，購物平臺帳號密碼的通病，就是面對記住不同的網站所有的用戶帳號與密碼，乾脆一個帳號與密碼通用於各個購物網站，密碼最好不要太複雜，不如選個容易記的通用密碼，也是人性的弱點。

當然，駭客也注意了這個現象，並且加以利用，開發攻擊程式輸入帳號再配合弱密碼，目前網站的回應處理速度很快，可能幾分鐘以內，就可以完成數千甚至上萬個帳號以上成功配對，同時駭客也能以此方式存取到消費者其他網站的資料。

對於網站的資安防護而言，短時間大量的登入成功難以辨認是否為真正消費者登入的行為? 只是單位時間的數量較多，難以判斷是否屬於惡意樣式的行為模式，真的很難預防。

對於這種的網路攻擊手法，是否有對應的策略呢? 首先，問題來自一個密碼通行於各大網站，這是人性，儘管三令五申要求購物網站定期要求用戶更換密碼，但經營者為了避免影響用戶使用的便利，依舊不願意配合強制定期更換密碼，這種營業營利的需求很難由主管機關強制實施。

## 攻擊者如何獲取用戶名稱和密碼的清單

1. 1 洩露和外洩：從第三方泄露的資料中獲取。這些可能是從其他網站或服務的數據洩露中收集的用戶名和密碼組合。

2. 2 社交工程：透過社交工程技術，詐騙方式或偽裝攻擊來騙取用戶名稱和密碼。攻擊者可能會假冒合法機構或人員，要求用戶提供其帳號資訊。

3. 3 釣魚攻擊：透過電子郵件、短信或偽裝的網站頁面，誘導用戶輸入其帳戶資訊，攻擊者在背後收集這些信息。

4. 4 弱點和漏洞利用：利用已知的系統漏洞或弱點，進行攻擊以獲取用戶資訊。這可能包括系統弱點、未修補的安全漏洞或不安全的設定。

## 自動化登入過程
一旦攻擊者獲得用戶名和密碼清單，他們可能會使用自動化工具來進行大規模的登入嘗試：

1. 1 暴力破解攻擊：使用自動化工具（如Brutus、Hydra等）進行不斷的用戶名和密碼組合嘗試，直到找到有效的登入組合。

2. 2 字典攻擊：使用預先準備好的字典檔案，包含可能的常見密碼、常見字詞或數字組合，來進行登入嘗試。

3. 3 Credential Stuffing：利用從其他社群平台個資外洩中獲得的用戶名稱和密碼組合，在其他網站上進行大規模的登入嘗試，以尋找共用的登入資訊。

## 電商針對撞庫攻擊的作為

大部分的電商都不願意主動要求用戶更改密碼，認為這會影響其業務，因此不會將定期密碼的更換當作資安防護工作。但從另外一個角度來看，有的電商願意定期提供優惠方式，主動聯絡客戶，只要願意更換密碼，就提供折價的優惠，這是蠻主動積極的作法。其實，國內有數家電商就依照這種模式，不僅維持客戶的關係，也促進營業額的增長，更保護客戶的密碼安全性。

## 應用防護措施的加強

至於資訊安全的控制措施，因為這種攻擊方式來自網頁的查詢，倒是可以利用網頁應用防火牆(WAF)予以阻擋，鑑於部分用戶沒有使用防毒軟體， 以至於電腦遭惡意軟體挾持，登入網站單憑用戶帳號與密碼無法確定是用戶本人。

1.	1 用戶登入增加OTP(one time password)，進行二次驗證，網站檢驗登入帳號與密碼後，用戶還需要輸入手機驗證碼。

2.	2 用戶帳號一天以內重複三次登入失敗，必須強制要求用戶修改密碼。

3.	3 目前的WAF可以設定每秒鐘同一個IP 登入的要求超過7次就認定為是不懷好意的行為，可以暫時停止這個IP登入的查詢一天。

4.	4 WAF也可判斷對於每三秒鐘頁面查詢30次以上的IP，視為機器人自動阻擋，人類的使用速度沒這麼快，這也是針對機器人很好處理方式。

5.	5 針對網路機器人登入之後立即切換查詢頁面到會員專區， 因此，可以要求用戶再輸入OTP，確認用戶本人。

## 善用機器人偵測

對於大量網頁的登入是採取程式極短時間連續執行，也就是網路機器人。Google於2018 年11 月所提供recaptcha v3是在網站中所有的頁面都會有 reCaptcha 的追蹤功能，讓網站的每一個位置都能夠分析惡意程式的存在。多位用過的資訊人員都讚不絕口，覺得reCaptcha 做了很多事情，遠超過想像，這也是防止撞庫攻擊的一項很好的工具。

## 良好的密碼使用

以上提到撞庫攻擊，本質上是針對一種不良的密碼管理方式。如果密碼不是輕易被猜測，這種攻擊就會消失。 因此，良好的密碼使用習慣應該是:

![圖片說明：密碼長度。出處：HIVE SYSTEMS](/assets/blog/csa/password.jpg)
上圖取自HIVE SYSTEMS

1.	1 所有的帳號不要使用相同的密碼
2.	2 使用長度較長（15位元以上）的密碼，英文數字混用，長度比複雜度更重要
3.	3 密碼不要告訴別人;否則請立即更換
4.	4 定期更換密碼


對於撞庫攻擊這件事，用戶可以做到以上幾點密碼的保護處理帳戶安全。

## 撞庫攻擊所產生的影響以及後果
撞庫攻擊是駭客嘗試通過大量嘗試用戶名稱和密碼的組合來非法存取系統或應用程序的手法。這樣的攻擊可能導致多方面的影響和嚴重後果。

首先，個人資料外洩是一個主要風險。如果攻擊者成功獲取用戶帳號和密碼，可能訪問到敏感的個人信息，如姓名、地址、聯繫方式等。這樣的洩露可能導致個人資料外洩、釣魚攻擊，甚至用於更廣泛的社交工程攻擊，對個人隱私構成嚴重威脅。

其次，撞庫攻擊可能導致金錢損失。如果駭客能夠獲取用戶的銀行帳戶資訊或信用卡數據，他們可能用於盜刷或非法交易，給個人和公司帶來財務損失，同時也會給用戶帶來經濟損害和信用卡糾紛。

最後，公司聲譽的損害也是一個重要因素。一旦公司遭受撞庫攻擊，公眾和客戶可能失去對其安全性的信任。這可能導致客戶流失、聲譽受損和法律責任，對企業長期發展產生負面影響。

總而言之，撞庫攻擊不僅會導致個人隱私外洩和財務損失，還可能對公司聲譽產生長期的負面影響。因此，實施有效的安全措施和持續的監控對於預防和應對這類攻擊至關重要。

## 結論

撞庫攻擊是一種常見的網路攻擊方式，其本質是利用用戶不良的密碼管理習慣。這種攻擊方式的存在，強烈提示我們必須建立良好的密碼使用習慣。這包括：不要為所有帳號使用相同的密碼，使用長度較長且包含英文數字的密碼，不將密碼告訴他人，並定期更換密碼。

只有當所有用戶都能遵循這些基本的密碼管理原則，我們才能有效地防止撞庫攻擊。因此，教育用戶如何正確地管理他們的密碼，是防止撞庫攻擊的關鍵。

在過去，企業經常依賴Recaptcha來增強網站的安全性，因為它可以有效地防止自動化的攻擊。然而，隨著我們進入這個被稱為"黑暗時代"的新時期，攻擊者已經開始使用AI技術來辨識和通過Recaptcha。這種AI的辨識能力甚至超越了人類，使得Recaptcha的防護效果大大降低。因此，企業必須重新考慮他們的網站安全策略，並尋找新的方法來防止這種先進的攻擊。

此外，對於企業和組織來說，他們應該提供更安全的認證方式，如雙因子認證或生物識別技術，以增加對撞庫攻擊的防護。這樣，即使用戶的密碼被猜測出來，攻擊者也無法獲得完全的訪問權限。

## 參考資料

1. 1 圖分別取自 Unsplash， 以及由 Windows Copilot Image Create from Designer 產生。
2. 2 部分文字由GitHub Copilot 潤飾
3. 3 部分文字經由Chat GTP潤飾